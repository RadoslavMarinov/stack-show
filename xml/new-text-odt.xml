<project basedir="../../../" name="do-report" default="extract-common-paths">
	<xmlproperty keeproot="false" file="implementation/xml/ant/properties.xml"/>
	<!--	-->
	<taskdef resource="net/sf/antcontrib/antlib.xml">
		<classpath>
			<pathelement location="${infrastructure-base-dir}/apache-ant-1.9.6/lib/antcontrib.jar"/>
		</classpath>
	</taskdef>
	<!--	-->
	<macrodef name="get-common-path">
		<attribute name="common-path-property"/>
		<attribute name="file"/>
		<attribute name="file-base-dir"/>
		<sequential>
			<local name="file-dir-absolute-path"/>
			<dirname property="file-dir-absolute-path" file="@{file}"/>
			<property name="file-base-dir-absolute-path" location="@{file-base-dir}"/>
			<echo>MACRODEF FILE: ${file-dir-absolute-path}</echo>
			<echo>MACRODEF FILE-BASE-DIR: ${file-base-dir-absolute-path}</echo>
			<pathconvert property="@{common-path-property}" dirsep="/">
				<path location="${file-dir-absolute-path}"/>
				<map from="${file-base-dir-absolute-path}/" to=""/>
			</pathconvert>
		</sequential>
	</macrodef>
	<!--	-->
	<target name="clean">
		<delete dir="${dita-odt.path.odt-unzipped-base-dir}" includeemptydirs="true" failonerror="no"/>
		<delete dir="examples/intermediate/odt-files" includeemptydirs="true" failonerror="no"/>
	</target>
	<!--	-->
	<target name="unzip-writing-odt-file" depends="clean">
		<unzip src="${dita-odt.path.writing-odt}" dest="${dita-odt.path.writing-odt-unzipped}"/>
	</target>
	<!--	-->
	<target name="extract-common-paths" depends="unzip-writing-odt-file">
		<for param="file">
			<path>
				<fileset dir="${dita-odt.path.text-xml-base-dir}">
					<include name="**/content.xml"/>
				</fileset>
			</path>
			<sequential>
				<get-common-path common-path-property="common-path" file="@{file}" file-base-dir="${dita-odt.path.text-xml-base-dir}"/>
				<echo>THIS IS THE PATH: ${common-path}</echo>
			</sequential>
		</for>
	</target>
	</project>